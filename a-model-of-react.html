
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="stylesheet" href="./style.css">
<link rel="stylesheet" href="./github.min.css">
<title>A model of React</title>
</head>
<body><h1>A model of React</h1>
<pre><code class="hljs language-plaintext">
              setState
                  │
                  │
      f           │
   ─────────┐     ▼   VDOM = f(state)            diff result           mutate
            ├──►React────────────────►Reconciler─────────────►Renderer────────►DOM────►Layout Effect──►Browser render────►Effect(next tick)
   ─────────┘    │ ▲                    │  ▲
initialState     │ │                    │  │
                 ▼ │                    ▼  │
                State                 Scheduler
</code></pre><p><code>f</code> is composed of functional components.
<code>initialState</code> consists of all initial values passed to <code>useState</code>.
Props are either constants or derived from states, so props can be regarded as part of the <code>state</code>.</p>
<p>React apply <code>f</code> to <code>state</code> to generate a VDOM(Virtual DOM). Every time <code>setState</code> is called, a new VDOM is generated by React. Then, the Reconciler compares the new VDOM with the old VDOM and passes the result to the Renderer.</p>
<p>In a browser, the Renderer is just react-dom. react-dom mutate DOM according to the diff result.</p>
<p>Now, layout effects are executed synchronously, then yield control to the browser. The browser renders the new DOM to the screen.
In the next tick of the event loop, effects will be executed.</p>
<p>Actually, React generates new VDOM from the node whose state is set to a new value, for performance.</p>
</body>
</html>
          